import Admonition from '@components/Admonition.astro'

# Context Switching

Each time the CPU stops running one task and starts another, it performs a [context switch](https://en.wikipedia.org/wiki/Context_switch). During a context switch the scheduler saves the outgoing task’s state—its registers, stack pointer, program counter, and other bits—then loads the incoming task’s saved state before letting it run.

<Admonition title="A Context Switch">
  A context switch is the process of **storing** the state of a **process** or
  **thread**, so that it can be restored and resume execution at a later point,
  and then **restoring** a different, previously saved, state.
</Admonition>

Context switches are **expensive operations** because they involve multiple steps: saving and loading CPU registers, updating memory mappings, and flushing caches.

- For **processes**, context switches include swapping address-space information (page tables, etc.)
- For **threads** within the same process there’s no address-space swap, but the register and stack state still changes. These switches happen quickly, but they’re not free, so minimizing unnecessary context switching helps performance.