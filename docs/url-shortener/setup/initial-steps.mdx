# Setup

Let's create our project root folder under `docs/url-shortener/code`. This keeps the playground isolated from other samples while letting us run `go test -race` and other tooling in a clean environment.

## Module Initialization

- Initialize a Go module: `go mod init urlshortener`.

## Bootstrapping the Server

We'll structure our HTTP server in a couple different files:

```sh
urlshortener/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ server/
â”‚       â””â”€â”€ main.go          # Application entry point
â””â”€â”€ internal/
    â””â”€â”€ api/
        â””â”€â”€ router.go        # Router with handlers
```

The rationale for this is, that having all the handlers in `main.go`, becomes a mess once you keep adding more endpoints.

1. This is `cmd/server/main.go`:

```go
func main() {
	appRouter := api.NewRouter()        // ðŸ”§ assemble router
	addr := fmt.Sprintf(":%s", port())  // ðŸš€ start HTTP server
	log.Printf("listening on %s", addr) // ðŸªµ log some message
	if err := http.ListenAndServe(addr, appRouter); err != nil {
		log.Fatalf("server stopped: %v", err)
	}
}
```

2. And this is `internal/api/router.go`:

```go
func NewRouter() http.Handler {
	mux := http.NewServeMux()
	mux.HandleFunc("/healthz", healthHandler)
	mux.HandleFunc("/", rootHandler)
	return mux
}

func rootHandler(w http.ResponseWriter, r *http.Request) {
	http.ServeFile(w, r, "ui/index.html")
}
```

## Running the Setup

If we start the server:

```sh
go run ./cmd/server
```

The root route now serves `ui/index.html`, keeping a simple front-end starter page separate from Go internals.

We can test this out with `curl`

```
curl -i localhost:8080/healthz

HTTP/1.1 200 OK
Date: Sat, 24 Jan 2026 12:00:00 GMT
Content-Length: 2
Content-Type: text/plain; charset=utf-8

ok
```

## Adding a UI

In our `internal/api/router.go`, let's refactor our `rootHandler`:

```go
func rootHandler(w http.ResponseWriter, r *http.Request) {
	http.ServeFile(w, r, "ui/index.html")
}
```

We're serving the following file:

```sh
urlshortener/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ server/
â”‚       â””â”€â”€ main.go
â”œâ”€â”€ ui/
â”‚   â””â”€â”€ index.html      # Serving an HTML file
â””â”€â”€ internal/
    â””â”€â”€ api/
        â””â”€â”€ router.go        # Router with handlers
```